{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://get.aiware.com/schemas/v2/contracts.json",
  "title": "CapabilityContracts",
  "description": "Defines the contracts for various engine capabilities and objects",
  "definitions": {
    "capabilityAnomaly": {
      "$comment": "Capability Anomaly: there must be an 'object' or 'series' and all objects must be of type 'anomaly'",
      "if": {
        "required": [
          "validationContracts"
        ],
        "properties": {
          "validationContracts": {
            "contains": {
              "const": "anomaly"
            }
          }
        }
      },
      "then": {
        "anyOf": [
          {
            "$comment": "All objects must be of type 'anomaly'",
            "required": [
              "object"
            ],
            "properties": {
              "object": {
                "type": "array",
                "items": {
                  "required": [
                    "type"
                  ],
                  "properties": {
                    "type": {
                      "const": "anomaly"
                    }
                  }
                }
              }
            }
          },
          {
            "$comment": "All series may only contain objects of type 'anomaly'",
            "required": [
              "series"
            ],
            "properties": {
              "series": {
                "type": "array",
                "items": {
                  "required": [
                    "object"
                  ],
                  "properties": {
                    "object": {
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "const": "anomaly"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        ]
      }
    },
    "capabilityConcept": {
      "$comment": "Capability Concept: must only contain 'object's of type 'concept'",
      "if": {
        "required": [
          "validationContracts"
        ],
        "properties": {
          "validationContracts": {
            "contains": {
              "const": "concept"
            }
          }
        }
      },
      "then": {
        "required": [
          "object"
        ],
        "properties": {
          "object": {
            "type": "array",
            "items": {
              "required": [
                "type"
              ],
              "properties": {
                "type": {
                  "const": "concept"
                }
              }
            }
          }
        }
      }
    },
    "capabilityEntity": {
      "$comment": "Capability Entity: must only contain 'object's of type 'namedEntity' with a 'label' or 'entityId' property",
      "if": {
        "required": [
          "validationContracts"
        ],
        "properties": {
          "validationContracts": {
            "contains": {
              "const": "entity"
            }
          }
        }
      },
      "then": {
        "required": [
          "object"
        ],
        "properties": {
          "object": {
            "type": "array",
            "items": {
              "required": [
                "type"
              ],
              "properties": {
                "type": {
                  "const": "namedEntity"
                }
              },
              "anyOf": [
                {
                  "required": [
                    "label"
                  ]
                },
                {
                  "required": [
                    "entityId"
                  ]
                }
              ]
            }
          }
        }
      }
    },
    "capabilityLanguage": {
      "$comment": "Capability Language: the root object must contain a 'language' property",
      "if": {
        "required": [
          "validationContracts"
        ],
        "properties": {
          "validationContracts": {
            "contains": {
              "const": "language"
            }
          }
        }
      },
      "then": {
        "required": [
          "language"
        ]
      }
    },
    "objectLicensePlate": {
      "$comment": "Object of type 'licensePlate' MUST include licensePlate property, MAY include label, boundingPoly",
      "if": {
        "properties": {
          "type": {
            "const": "licensePlate"
          }
        }
      },
      "then": {
        "properties": {
          "type": {},
          "licensePlate": {},
          "label": {},
          "boundingPoly": {}
        },
        "required": [
          "type",
          "licensePlate"
        ],
        "additionalProperties": false
      }
    },
    "objectMotorVehicle": {
      "$comment": "Object of type 'motorVehicle' MUST include motorVehicle property, MAY include label, boundingPoly",
      "if": {
        "properties": {
          "type": {
            "const": "motorVehicle"
          }
        }
      },
      "then": {
        "properties": {
          "type": {},
          "motorVehicle": {},
          "label": {},
          "boundingPoly": {}
        },
        "required": [
          "type",
          "motorVehicle"
        ],
        "additionalProperties": false
      }
    }
  }
}