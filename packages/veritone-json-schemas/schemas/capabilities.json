{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://get.aiware.com/schemas/capabilities.json",
  "title": "CapabilityContracts",
  "description": "Defines the contracts for various engine capabilities",
  "definitions": {
    
    "anomaly": {
      "$comment": "If contracts contains 'anomaly', then there must be an 'object' or 'series' and all objects must be of type 'anomaly'",
      "if": {
        "required": ["validationContracts"],
        "properties": { "validationContracts": { "contains": { "const": "anomaly" } } }
      },
      "then": {
        "anyOf": [
          {
            "$comment": "All objects must be of type 'anomaly'",
            "required": ["object"],
            "properties": {
              "object": {
                "type": "array",
                "items": {
                  "required": ["type"],
                  "properties": {
                    "type": { "const": "anomaly" }
                  }
                }
              }
            }
          },
          {
            "$comment": "All series may only contain objects of type 'anomaly'",
            "required": ["series"],
            "properties": {
              "series": {
                "type": "array",
                "items": {
                  "required": ["object"],
                  "properties": {
                    "object": {
                      "required": ["type"],
                      "properties": {
                        "type": { "const": "anomaly" }
                      }
                    }
                  }
                }
              }
            }
          }
        ]
      }
    },
    
    "language": {
      "$comment": "If contracts contains 'language', then the root object must contain a 'language' property",
      "if": {
        "required": ["validationContracts"],
        "properties": { "validationContracts": { "contains": { "const": "language" } } }
      },
      "then": {
        "required": ["language"]
      }
    }
  }
}
